GAS LISTING /tmp/cc8opo8y.s 			page 1


   1              		.file	"interruptRoutine.cpp"
   2              		.option pic
   3              		.option norelax
   4              		.text
   5              	.Ltext0:
   6              		.section	.rodata.str1.8,"aMS",@progbits,1
   7              		.align	3
   8              	.LC0:
   9 0000 4E65706F 		.string	"Nepostojeci op code"
   9      73746F6A 
   9      65636920 
   9      6F702063 
   9      6F646500 
  10 0014 00000000 		.align	3
  11              	.LC1:
  12 0018 47726573 		.string	"Greska u prekidnoj rutini"
  12      6B612075 
  12      20707265 
  12      6B69646E 
  12      6F6A2072 
  13              		.text
  14              		.align	2
  15              		.globl	interruptRoutine
  17              	interruptRoutine:
  18              	.LFB17:
  19              		.file 1 "src/interruptRoutine.cpp"
   1:src/interruptRoutine.cpp **** //
   2:src/interruptRoutine.cpp **** // Created by os on 5/22/23.
   3:src/interruptRoutine.cpp **** //
   4:src/interruptRoutine.cpp **** 
   5:src/interruptRoutine.cpp **** #include "../lib/console.h"
   6:src/interruptRoutine.cpp **** #include "../lib/hw.h"
   7:src/interruptRoutine.cpp **** #include "../h/MemoryAllocator.hpp"
   8:src/interruptRoutine.cpp **** #include "../h/helper.hpp"
   9:src/interruptRoutine.cpp **** #include "../h/riscv.hpp"
  10:src/interruptRoutine.cpp **** #include "../h/syscall_c.hpp"
  11:src/interruptRoutine.cpp **** 
  12:src/interruptRoutine.cpp **** extern "C" void interruptRoutine() {
  20              		.loc 1 12 36
  21              		.cfi_startproc
  22 0000 130101FD 		addi	sp,sp,-48
  23              		.cfi_def_cfa_offset 48
  24 0004 23341102 		sd	ra,40(sp)
  25 0008 23308102 		sd	s0,32(sp)
  26 000c 233C9100 		sd	s1,24(sp)
  27              		.cfi_offset 1, -8
  28              		.cfi_offset 8, -16
  29              		.cfi_offset 9, -24
  30 0010 13040103 		addi	s0,sp,48
  31              		.cfi_def_cfa 8, 0
  13:src/interruptRoutine.cpp **** 	uint64 scause = Riscv::r_scause();
  32              		.loc 1 13 2
  33              	.LBB14:
  34              	.LBB15:
  35              		.file 2 "src/../h/riscv.hpp"
   1:src/../h/riscv.hpp **** //
   2:src/../h/riscv.hpp **** // Created by os on 5/17/23.
GAS LISTING /tmp/cc8opo8y.s 			page 2


   3:src/../h/riscv.hpp **** //
   4:src/../h/riscv.hpp **** 
   5:src/../h/riscv.hpp **** #ifndef PROJEKAT2023_RISCV_HPP
   6:src/../h/riscv.hpp **** #define PROJEKAT2023_RISCV_HPP
   7:src/../h/riscv.hpp **** 
   8:src/../h/riscv.hpp **** #include "../lib/hw.h"
   9:src/../h/riscv.hpp **** 
  10:src/../h/riscv.hpp **** class Riscv {
  11:src/../h/riscv.hpp **** public:
  12:src/../h/riscv.hpp **** 
  13:src/../h/riscv.hpp **** 	//stavljanje registara x3-x31 na stek
  14:src/../h/riscv.hpp **** 	static void pushRegisters();    //implementacija u asm
  15:src/../h/riscv.hpp **** 
  16:src/../h/riscv.hpp **** 	//skidanje registara x3-x31 sa steka
  17:src/../h/riscv.hpp **** 	static void popRegisters();     //implementacija u asm
  18:src/../h/riscv.hpp **** 
  19:src/../h/riscv.hpp **** 	//read scause
  20:src/../h/riscv.hpp **** 	static uint64 r_scause();
  21:src/../h/riscv.hpp **** 
  22:src/../h/riscv.hpp **** 	//write scause
  23:src/../h/riscv.hpp **** 	static void w_scause(uint64 scause);
  24:src/../h/riscv.hpp **** 
  25:src/../h/riscv.hpp **** 	//read sepc
  26:src/../h/riscv.hpp **** 	static uint64 r_sepc();
  27:src/../h/riscv.hpp **** 
  28:src/../h/riscv.hpp **** 	//write sepc
  29:src/../h/riscv.hpp **** 	static void w_sepc(uint64 sepc);
  30:src/../h/riscv.hpp **** 
  31:src/../h/riscv.hpp **** 	//read stvec
  32:src/../h/riscv.hpp **** 	static uint64 r_stvec();
  33:src/../h/riscv.hpp **** 
  34:src/../h/riscv.hpp **** 	//write stvec
  35:src/../h/riscv.hpp **** 	static void w_stvec(uint64 stvec);
  36:src/../h/riscv.hpp **** 
  37:src/../h/riscv.hpp **** 	enum BitMaskSip {
  38:src/../h/riscv.hpp **** 		SIP_SSIP = (1 << 1),    //postoji zahtev za softverski prekid
  39:src/../h/riscv.hpp **** 		SIP_STIP = (1 << 5),    //postoji prekid od tajmera
  40:src/../h/riscv.hpp **** 		SIP_SEIP = (1 << 9)        //postoji zahtev za spoljasnji hardverski prekid
  41:src/../h/riscv.hpp **** 	};
  42:src/../h/riscv.hpp **** 
  43:src/../h/riscv.hpp **** 	//mask set sip
  44:src/../h/riscv.hpp **** 	static void ms_sip(uint64 mask);
  45:src/../h/riscv.hpp **** 
  46:src/../h/riscv.hpp **** 	//mask clear sip
  47:src/../h/riscv.hpp **** 	static void mc_sip(uint64 mask);
  48:src/../h/riscv.hpp **** 
  49:src/../h/riscv.hpp **** 	//read sip
  50:src/../h/riscv.hpp **** 	static uint64 r_sip();
  51:src/../h/riscv.hpp **** 
  52:src/../h/riscv.hpp **** 	//write sip
  53:src/../h/riscv.hpp **** 	static void w_sip(uint64 sip);
  54:src/../h/riscv.hpp **** 
  55:src/../h/riscv.hpp **** 	enum BitMaskSstatus {
  56:src/../h/riscv.hpp **** 		SSTATUS_SIE = (1 << 1),
  57:src/../h/riscv.hpp **** 		SSTATUS_SPIE = (1 << 5),
  58:src/../h/riscv.hpp **** 		SSTATUS_SPP = (1 << 8)
  59:src/../h/riscv.hpp **** 	};
GAS LISTING /tmp/cc8opo8y.s 			page 3


  60:src/../h/riscv.hpp **** 
  61:src/../h/riscv.hpp **** 	//mask set sstatus
  62:src/../h/riscv.hpp **** 	static void ms_sstatus(uint64 mask);
  63:src/../h/riscv.hpp **** 
  64:src/../h/riscv.hpp **** 	//mask clear sstatus
  65:src/../h/riscv.hpp **** 	static void mc_sstatus(uint64 mask);
  66:src/../h/riscv.hpp **** 
  67:src/../h/riscv.hpp **** 	//read sstatus
  68:src/../h/riscv.hpp **** 	static uint64 r_sstatus();
  69:src/../h/riscv.hpp **** 
  70:src/../h/riscv.hpp **** 	//write sstatus
  71:src/../h/riscv.hpp **** 	static void w_sstatus(uint64 sstatus);
  72:src/../h/riscv.hpp **** 
  73:src/../h/riscv.hpp **** };
  74:src/../h/riscv.hpp **** 
  75:src/../h/riscv.hpp **** inline uint64 Riscv::r_scause() {
  76:src/../h/riscv.hpp **** 	uint64 volatile scause;
  36              		.loc 2 76 2
  77:src/../h/riscv.hpp **** 	__asm__ volatile("csrr %[scause], scause": [scause] "=r"(scause));
  37              		.loc 2 77 2
  38              		.loc 2 77 67 is_stmt 0
  39              	#APP
  40              	# 77 "src/../h/riscv.hpp" 1
  78              		return scause;
  41              		csrr a5, scause
  42              	# 0 "" 2
  43              	#NO_APP
  44 0018 233CF4FC 		sd	a5,-40(s0)
  45              		.loc 2 78 2 is_stmt 1
  46              		.loc 2 78 9 is_stmt 0
  47 001c 033784FD 		ld	a4,-40(s0)
  48              	.LVL0:
  49              	.LBE15:
  50              	.LBE14:
  14:src/interruptRoutine.cpp **** 	uint64 sepc = Riscv::r_sepc();
  51              		.loc 1 14 2 is_stmt 1
  52              	.LBB16:
  53              	.LBB17:
  79:src/../h/riscv.hpp **** }
  80:src/../h/riscv.hpp **** 
  81:src/../h/riscv.hpp **** inline void Riscv::w_scause(uint64 scause) {
  82:src/../h/riscv.hpp **** 	__asm__ volatile("csrw scause, %[scause]": :[scause] "r"(scause));
  83:src/../h/riscv.hpp **** }
  84:src/../h/riscv.hpp **** 
  85:src/../h/riscv.hpp **** inline uint64 Riscv::r_sepc() {
  86:src/../h/riscv.hpp **** 	uint64 volatile sepc;
  54              		.loc 2 86 2
  87:src/../h/riscv.hpp **** 	__asm__ volatile("csrr %[sepc], sepc": [sepc] "=r"(sepc));
  55              		.loc 2 87 2
  56              		.loc 2 87 59 is_stmt 0
  57              	#APP
  58              	# 87 "src/../h/riscv.hpp" 1
  88              		return sepc;
  59              		csrr a5, sepc
  60              	# 0 "" 2
  61              	#NO_APP
  62 0024 2338F4FC 		sd	a5,-48(s0)
GAS LISTING /tmp/cc8opo8y.s 			page 4


  63              		.loc 2 88 2 is_stmt 1
  64              		.loc 2 88 9 is_stmt 0
  65 0028 833404FD 		ld	s1,-48(s0)
  66              	.LVL1:
  67              	.LBE17:
  68              	.LBE16:
  15:src/interruptRoutine.cpp **** 
  16:src/interruptRoutine.cpp **** 	if (scause == 0x09 || scause == 0x08) {
  69              		.loc 1 16 2 is_stmt 1
  70              	.LBB18:
  71              		.loc 1 16 21 is_stmt 0
  72 002c 930687FF 		addi	a3,a4,-8
  73              		.loc 1 16 2
  74 0030 93071000 		li	a5,1
  75 0034 63F8D702 		bleu	a3,a5,.L12
  17:src/interruptRoutine.cpp **** 		//prekid zbog poziva ecall
  18:src/interruptRoutine.cpp **** 		uint64 opCode;
  19:src/interruptRoutine.cpp **** 		__asm__ volatile("mv %[op], a0":[op] "=r"(opCode));
  20:src/interruptRoutine.cpp **** 
  21:src/interruptRoutine.cpp **** 		switch (opCode) {
  22:src/interruptRoutine.cpp **** 			case 0x01:
  23:src/interruptRoutine.cpp **** 				//mem_alloc
  24:src/interruptRoutine.cpp **** 				size_t size;
  25:src/interruptRoutine.cpp **** 				__asm__ volatile("mv %[size], a1":[size] "=r"(size));
  26:src/interruptRoutine.cpp **** 				size = size * MEM_BLOCK_SIZE;
  27:src/interruptRoutine.cpp **** 				MemoryAllocator::kmalloc(size);
  28:src/interruptRoutine.cpp **** 				break;
  29:src/interruptRoutine.cpp **** 			case 0x02:
  30:src/interruptRoutine.cpp **** 				//mem_free
  31:src/interruptRoutine.cpp **** 				void* ptr;
  32:src/interruptRoutine.cpp **** 				__asm__ volatile("mv %[ptr], a1" :[ptr]"=r"(ptr));
  33:src/interruptRoutine.cpp **** 				MemoryAllocator::kfree(ptr);
  34:src/interruptRoutine.cpp **** 				break;
  35:src/interruptRoutine.cpp **** 			case 0x11:
  36:src/interruptRoutine.cpp **** 				//thread_create
  37:src/interruptRoutine.cpp **** 				break;
  38:src/interruptRoutine.cpp **** 			case 0x12:
  39:src/interruptRoutine.cpp **** 				//thread_exit
  40:src/interruptRoutine.cpp **** 				break;
  41:src/interruptRoutine.cpp **** 			case 0x13:
  42:src/interruptRoutine.cpp **** 				//thread_dispatch
  43:src/interruptRoutine.cpp **** 				break;
  44:src/interruptRoutine.cpp **** 			case 0x14:
  45:src/interruptRoutine.cpp **** 				//thread_join
  46:src/interruptRoutine.cpp **** 				break;
  47:src/interruptRoutine.cpp **** 			case 0x21:
  48:src/interruptRoutine.cpp **** 				//sem_open
  49:src/interruptRoutine.cpp **** 				break;
  50:src/interruptRoutine.cpp **** 			case 0x22:
  51:src/interruptRoutine.cpp **** 				//sem_close
  52:src/interruptRoutine.cpp **** 				break;
  53:src/interruptRoutine.cpp **** 			case 0x23:
  54:src/interruptRoutine.cpp **** 				//sem_wait
  55:src/interruptRoutine.cpp **** 				break;
  56:src/interruptRoutine.cpp **** 			case 0x24:
  57:src/interruptRoutine.cpp **** 				//sem_signal
  58:src/interruptRoutine.cpp **** 				break;
GAS LISTING /tmp/cc8opo8y.s 			page 5


  59:src/interruptRoutine.cpp **** 			case 0x31:
  60:src/interruptRoutine.cpp **** 				//time_sleep
  61:src/interruptRoutine.cpp **** 				break;
  62:src/interruptRoutine.cpp **** 			case 0x41:
  63:src/interruptRoutine.cpp **** 				//getc
  64:src/interruptRoutine.cpp **** 				break;
  65:src/interruptRoutine.cpp **** 			case 0x42:
  66:src/interruptRoutine.cpp **** 				//putc
  67:src/interruptRoutine.cpp **** 				break;
  68:src/interruptRoutine.cpp **** 			default:
  69:src/interruptRoutine.cpp **** 				println("Nepostojeci op code");
  70:src/interruptRoutine.cpp **** 				break;
  71:src/interruptRoutine.cpp **** 		}
  72:src/interruptRoutine.cpp **** 		//sepc pokazuje na ecall instrukciju, treba preci na sledecu instrukciju
  73:src/interruptRoutine.cpp **** 		Riscv::w_sepc(sepc + 4);
  74:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 9)) {
  76              		.loc 1 74 9 is_stmt 1
  77 0038 9307F0FF 		li	a5,-1
  78 003c 9397F703 		slli	a5,a5,63
  79 0040 93879700 		addi	a5,a5,9
  80 0044 630CF708 		beq	a4,a5,.L13
  75:src/interruptRoutine.cpp **** 		//spoljasnji hardverski prekid
  76:src/interruptRoutine.cpp **** 		console_handler();
  77:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 1)) {
  81              		.loc 1 77 9
  82 0048 9307F0FF 		li	a5,-1
  83 004c 9397F703 		slli	a5,a5,63
  84 0050 93871700 		addi	a5,a5,1
  85 0054 631AF708 		bne	a4,a5,.L10
  78:src/interruptRoutine.cpp **** 		//prekid od tajmera
  79:src/interruptRoutine.cpp **** 		Riscv::mc_sip(Riscv::SIP_SSIP);
  86              		.loc 1 79 3
  87              	.LVL2:
  88              	.LBB19:
  89              	.LBB20:
  89:src/../h/riscv.hpp **** }
  90:src/../h/riscv.hpp **** 
  91:src/../h/riscv.hpp **** inline void Riscv::w_sepc(uint64 sepc) {
  92:src/../h/riscv.hpp **** 	__asm__ volatile("csrw sepc, %[sepc]": :[sepc] "r"(sepc));
  93:src/../h/riscv.hpp **** }
  94:src/../h/riscv.hpp **** 
  95:src/../h/riscv.hpp **** inline uint64 Riscv::r_stvec() {
  96:src/../h/riscv.hpp **** 	uint64 volatile stvec;
  97:src/../h/riscv.hpp **** 	__asm__ volatile("csrr %[stvec], stvec": [stvec] "=r"(stvec));
  98:src/../h/riscv.hpp **** 	return stvec;
  99:src/../h/riscv.hpp **** }
 100:src/../h/riscv.hpp **** 
 101:src/../h/riscv.hpp **** inline void Riscv::w_stvec(uint64 stvec) {
 102:src/../h/riscv.hpp **** 	__asm__ volatile("csrw stvec, %[stvec]": :[stvec] "r"(stvec));
 103:src/../h/riscv.hpp **** }
 104:src/../h/riscv.hpp **** 
 105:src/../h/riscv.hpp **** inline void Riscv::ms_sip(uint64 mask) {
 106:src/../h/riscv.hpp **** 	__asm__ volatile("csrs sip, %[mask]": :[mask] "r"(mask));
 107:src/../h/riscv.hpp **** }
 108:src/../h/riscv.hpp **** 
 109:src/../h/riscv.hpp **** inline void Riscv::mc_sip(uint64 mask) {
 110:src/../h/riscv.hpp **** 	__asm__ volatile("csrc sip, %[mask]": :[mask] "r"(mask));
GAS LISTING /tmp/cc8opo8y.s 			page 6


  90              		.loc 2 110 2
  91              		.loc 2 110 58 is_stmt 0
  92 0058 93072000 		li	a5,2
  93              	#APP
  94              	# 110 "src/../h/riscv.hpp" 1
 111              	}
  95              		csrc sip, a5
  96              	# 0 "" 2
  97              		.loc 2 111 1
  98              	#NO_APP
  99 0060 6F004004 		j	.L1
 100              	.LVL3:
 101              	.L12:
 102              	.LBE20:
 103              	.LBE19:
 104              	.LBB21:
  18:src/interruptRoutine.cpp **** 		__asm__ volatile("mv %[op], a0":[op] "=r"(opCode));
 105              		.loc 1 18 3 is_stmt 1
  19:src/interruptRoutine.cpp **** 
 106              		.loc 1 19 3
  19:src/interruptRoutine.cpp **** 
 107              		.loc 1 19 53 is_stmt 0
 108              	#APP
 109              	# 19 "src/interruptRoutine.cpp" 1
 110              		mv a5, a0
 111              	# 0 "" 2
 112              	.LVL4:
  21:src/interruptRoutine.cpp **** 			case 0x01:
 113              		.loc 1 21 3 is_stmt 1
 114              	#NO_APP
 115 0068 13072004 		li	a4,66
 116              	.LVL5:
 117 006c 636EF704 		bgtu	a5,a4,.L3
 118 0070 93972700 		slli	a5,a5,2
 119              	.LVL6:
 120 0074 17070000 		lla	a4,.L5
 120      13070700 
 121 007c B387E700 		add	a5,a5,a4
 122 0080 83A70700 		lw	a5,0(a5)
 123 0084 B387E700 		add	a5,a5,a4
 124 0088 67800700 		jr	a5
 125              		.section	.rodata
 126              		.align	2
 127              		.align	2
 128              	.L5:
 129 0000 00000000 		.word	.L3-.L5
 130 0004 00000000 		.word	.L7-.L5
 131 0008 00000000 		.word	.L6-.L5
 132 000c 00000000 		.word	.L3-.L5
 133 0010 00000000 		.word	.L3-.L5
 134 0014 00000000 		.word	.L3-.L5
 135 0018 00000000 		.word	.L3-.L5
 136 001c 00000000 		.word	.L3-.L5
 137 0020 00000000 		.word	.L3-.L5
 138 0024 00000000 		.word	.L3-.L5
 139 0028 00000000 		.word	.L3-.L5
 140 002c 00000000 		.word	.L3-.L5
GAS LISTING /tmp/cc8opo8y.s 			page 7


 141 0030 00000000 		.word	.L3-.L5
 142 0034 00000000 		.word	.L3-.L5
 143 0038 00000000 		.word	.L3-.L5
 144 003c 00000000 		.word	.L3-.L5
 145 0040 00000000 		.word	.L3-.L5
 146 0044 00000000 		.word	.L4-.L5
 147 0048 00000000 		.word	.L4-.L5
 148 004c 00000000 		.word	.L4-.L5
 149 0050 00000000 		.word	.L4-.L5
 150 0054 00000000 		.word	.L3-.L5
 151 0058 00000000 		.word	.L3-.L5
 152 005c 00000000 		.word	.L3-.L5
 153 0060 00000000 		.word	.L3-.L5
 154 0064 00000000 		.word	.L3-.L5
 155 0068 00000000 		.word	.L3-.L5
 156 006c 00000000 		.word	.L3-.L5
 157 0070 00000000 		.word	.L3-.L5
 158 0074 00000000 		.word	.L3-.L5
 159 0078 00000000 		.word	.L3-.L5
 160 007c 00000000 		.word	.L3-.L5
 161 0080 00000000 		.word	.L3-.L5
 162 0084 00000000 		.word	.L4-.L5
 163 0088 00000000 		.word	.L4-.L5
 164 008c 00000000 		.word	.L4-.L5
 165 0090 00000000 		.word	.L4-.L5
 166 0094 00000000 		.word	.L3-.L5
 167 0098 00000000 		.word	.L3-.L5
 168 009c 00000000 		.word	.L3-.L5
 169 00a0 00000000 		.word	.L3-.L5
 170 00a4 00000000 		.word	.L3-.L5
 171 00a8 00000000 		.word	.L3-.L5
 172 00ac 00000000 		.word	.L3-.L5
 173 00b0 00000000 		.word	.L3-.L5
 174 00b4 00000000 		.word	.L3-.L5
 175 00b8 00000000 		.word	.L3-.L5
 176 00bc 00000000 		.word	.L3-.L5
 177 00c0 00000000 		.word	.L3-.L5
 178 00c4 00000000 		.word	.L4-.L5
 179 00c8 00000000 		.word	.L3-.L5
 180 00cc 00000000 		.word	.L3-.L5
 181 00d0 00000000 		.word	.L3-.L5
 182 00d4 00000000 		.word	.L3-.L5
 183 00d8 00000000 		.word	.L3-.L5
 184 00dc 00000000 		.word	.L3-.L5
 185 00e0 00000000 		.word	.L3-.L5
 186 00e4 00000000 		.word	.L3-.L5
 187 00e8 00000000 		.word	.L3-.L5
 188 00ec 00000000 		.word	.L3-.L5
 189 00f0 00000000 		.word	.L3-.L5
 190 00f4 00000000 		.word	.L3-.L5
 191 00f8 00000000 		.word	.L3-.L5
 192 00fc 00000000 		.word	.L3-.L5
 193 0100 00000000 		.word	.L3-.L5
 194 0104 00000000 		.word	.L4-.L5
 195 0108 00000000 		.word	.L4-.L5
 196              		.text
 197              	.L7:
GAS LISTING /tmp/cc8opo8y.s 			page 8


 198              	.LBB22:
  22:src/interruptRoutine.cpp **** 				//mem_alloc
 199              		.loc 1 22 4
  24:src/interruptRoutine.cpp **** 				__asm__ volatile("mv %[size], a1":[size] "=r"(size));
 200              		.loc 1 24 5
  25:src/interruptRoutine.cpp **** 				size = size * MEM_BLOCK_SIZE;
 201              		.loc 1 25 5
  25:src/interruptRoutine.cpp **** 				size = size * MEM_BLOCK_SIZE;
 202              		.loc 1 25 57 is_stmt 0
 203              	#APP
 204              	# 25 "src/interruptRoutine.cpp" 1
 205              		mv a0, a1
 206              	# 0 "" 2
 207              	.LVL7:
  26:src/interruptRoutine.cpp **** 				MemoryAllocator::kmalloc(size);
 208              		.loc 1 26 5 is_stmt 1
  27:src/interruptRoutine.cpp **** 				break;
 209              		.loc 1 27 5
  27:src/interruptRoutine.cpp **** 				break;
 210              		.loc 1 27 29 is_stmt 0
 211              	#NO_APP
 212 0090 13156500 		slli	a0,a0,6
 213              	.LVL8:
 214 0094 97000000 		call	_ZN15MemoryAllocator7kmallocEm@plt
 214      E7800000 
 215              	.LVL9:
  28:src/interruptRoutine.cpp **** 			case 0x02:
 216              		.loc 1 28 5 is_stmt 1
 217              	.L4:
 218              	.LBE22:
  73:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 9)) {
 219              		.loc 1 73 3
  73:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 9)) {
 220              		.loc 1 73 16 is_stmt 0
 221 009c 93844400 		addi	s1,s1,4
 222              	.LVL10:
 223              	.LBB23:
 224              	.LBB24:
  92:src/../h/riscv.hpp **** }
 225              		.loc 2 92 2 is_stmt 1
  92:src/../h/riscv.hpp **** }
 226              		.loc 2 92 59 is_stmt 0
 227              	#APP
 228              	# 92 "src/../h/riscv.hpp" 1
 229              		csrw sepc, s1
 230              	# 0 "" 2
 231              	.LVL11:
 232              	#NO_APP
 233              	.L1:
 234              	.LBE24:
 235              	.LBE23:
 236              	.LBE21:
 237              	.LBE18:
  80:src/interruptRoutine.cpp **** 	} else {
  81:src/interruptRoutine.cpp **** 		println("Greska u prekidnoj rutini");
  82:src/interruptRoutine.cpp **** 	}
  83:src/interruptRoutine.cpp **** }
GAS LISTING /tmp/cc8opo8y.s 			page 9


 238              		.loc 1 83 1
 239 00a4 83308102 		ld	ra,40(sp)
 240              		.cfi_remember_state
 241              		.cfi_restore 1
 242 00a8 03340102 		ld	s0,32(sp)
 243              		.cfi_restore 8
 244              		.cfi_def_cfa 2, 48
 245 00ac 83348101 		ld	s1,24(sp)
 246              		.cfi_restore 9
 247 00b0 13010103 		addi	sp,sp,48
 248              		.cfi_def_cfa_offset 0
 249 00b4 67800000 		jr	ra
 250              	.LVL12:
 251              	.L6:
 252              		.cfi_restore_state
 253              	.LBB27:
 254              	.LBB26:
 255              	.LBB25:
  29:src/interruptRoutine.cpp **** 				//mem_free
 256              		.loc 1 29 4 is_stmt 1
  31:src/interruptRoutine.cpp **** 				__asm__ volatile("mv %[ptr], a1" :[ptr]"=r"(ptr));
 257              		.loc 1 31 5
  32:src/interruptRoutine.cpp **** 				MemoryAllocator::kfree(ptr);
 258              		.loc 1 32 5
  32:src/interruptRoutine.cpp **** 				MemoryAllocator::kfree(ptr);
 259              		.loc 1 32 54 is_stmt 0
 260              	#APP
 261              	# 32 "src/interruptRoutine.cpp" 1
 262              		mv a0, a1
 263              	# 0 "" 2
 264              	.LVL13:
  33:src/interruptRoutine.cpp **** 				break;
 265              		.loc 1 33 5 is_stmt 1
  33:src/interruptRoutine.cpp **** 				break;
 266              		.loc 1 33 27 is_stmt 0
 267              	#NO_APP
 268 00bc 97000000 		call	_ZN15MemoryAllocator5kfreeEPv@plt
 268      E7800000 
 269              	.LVL14:
  34:src/interruptRoutine.cpp **** 			case 0x11:
 270              		.loc 1 34 5 is_stmt 1
 271 00c4 6FF09FFD 		j	.L4
 272              	.LVL15:
 273              	.L3:
  68:src/interruptRoutine.cpp **** 				println("Nepostojeci op code");
 274              		.loc 1 68 4
  69:src/interruptRoutine.cpp **** 				break;
 275              		.loc 1 69 5
  69:src/interruptRoutine.cpp **** 				break;
 276              		.loc 1 69 12 is_stmt 0
 277 00c8 17050000 		lla	a0,.LC0
 277      13050500 
 278 00d0 97000000 		call	_Z7printlnPKc@plt
 278      E7800000 
 279              	.LVL16:
  70:src/interruptRoutine.cpp **** 		}
 280              		.loc 1 70 5 is_stmt 1
GAS LISTING /tmp/cc8opo8y.s 			page 10


 281 00d8 6FF05FFC 		j	.L4
 282              	.LVL17:
 283              	.L13:
 284              	.LBE25:
 285              	.LBE26:
  76:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 1)) {
 286              		.loc 1 76 3
  76:src/interruptRoutine.cpp **** 	} else if (scause == (1UL << 63 | 1)) {
 287              		.loc 1 76 18 is_stmt 0
 288 00dc 97000000 		call	console_handler@plt
 288      E7800000 
 289              	.LVL18:
 290 00e4 6FF01FFC 		j	.L1
 291              	.LVL19:
 292              	.L10:
  81:src/interruptRoutine.cpp **** 	}
 293              		.loc 1 81 3 is_stmt 1
  81:src/interruptRoutine.cpp **** 	}
 294              		.loc 1 81 10 is_stmt 0
 295 00e8 17050000 		lla	a0,.LC1
 295      13050500 
 296 00f0 97000000 		call	_Z7printlnPKc@plt
 296      E7800000 
 297              	.LVL20:
 298              	.LBE27:
 299              		.loc 1 83 1
 300 00f8 6FF0DFFA 		j	.L1
 301              		.cfi_endproc
 302              	.LFE17:
 304              	.Letext0:
 305              		.file 3 "src/../lib/hw.h"
 306              		.file 4 "src/../h/MemoryAllocator.hpp"
 307              		.file 5 "src/../h/syscall_c.hpp"
 308              		.file 6 "src/../h/helper.hpp"
 309              		.file 7 "src/../lib/console.h"
GAS LISTING /tmp/cc8opo8y.s 			page 11


DEFINED SYMBOLS
                            *ABS*:0000000000000000 interruptRoutine.cpp
     /tmp/cc8opo8y.s:17     .text:0000000000000000 interruptRoutine
     /tmp/cc8opo8y.s:21     .text:0000000000000000 .L0 
     /tmp/cc8opo8y.s:22     .text:0000000000000000 .L0 
     /tmp/cc8opo8y.s:23     .text:0000000000000004 .L0 
     /tmp/cc8opo8y.s:27     .text:0000000000000010 .L0 
     /tmp/cc8opo8y.s:28     .text:0000000000000010 .L0 
     /tmp/cc8opo8y.s:29     .text:0000000000000010 .L0 
     /tmp/cc8opo8y.s:31     .text:0000000000000014 .L0 
     /tmp/cc8opo8y.s:36     .text:0000000000000014 .L0 
     /tmp/cc8opo8y.s:37     .text:0000000000000014 .L0 
     /tmp/cc8opo8y.s:38     .text:0000000000000014 .L0 
  src/../h/riscv.hpp:77     .text:0000000000000014 .L0 
     /tmp/cc8opo8y.s:46     .text:000000000000001c .L0 
     /tmp/cc8opo8y.s:47     .text:000000000000001c .L0 
     /tmp/cc8opo8y.s:54     .text:0000000000000020 .L0 
     /tmp/cc8opo8y.s:55     .text:0000000000000020 .L0 
     /tmp/cc8opo8y.s:56     .text:0000000000000020 .L0 
  src/../h/riscv.hpp:87     .text:0000000000000020 .L0 
     /tmp/cc8opo8y.s:64     .text:0000000000000028 .L0 
     /tmp/cc8opo8y.s:65     .text:0000000000000028 .L0 
     /tmp/cc8opo8y.s:71     .text:000000000000002c .L0 
     /tmp/cc8opo8y.s:72     .text:000000000000002c .L0 
     /tmp/cc8opo8y.s:74     .text:0000000000000030 .L0 
     /tmp/cc8opo8y.s:77     .text:0000000000000038 .L0 
     /tmp/cc8opo8y.s:82     .text:0000000000000048 .L0 
     /tmp/cc8opo8y.s:90     .text:0000000000000058 .L0 
     /tmp/cc8opo8y.s:91     .text:0000000000000058 .L0 
     /tmp/cc8opo8y.s:92     .text:0000000000000058 .L0 
     /tmp/cc8opo8y.s:99     .text:0000000000000060 .L0 
     /tmp/cc8opo8y.s:106    .text:0000000000000064 .L0 
     /tmp/cc8opo8y.s:107    .text:0000000000000064 .L0 
src/interruptRoutine.cpp:19     .text:0000000000000064 .L0 
     /tmp/cc8opo8y.s:115    .text:0000000000000068 .L0 
     /tmp/cc8opo8y.s:200    .text:000000000000008c .L0 
     /tmp/cc8opo8y.s:201    .text:000000000000008c .L0 
     /tmp/cc8opo8y.s:202    .text:000000000000008c .L0 
src/interruptRoutine.cpp:25     .text:000000000000008c .L0 
     /tmp/cc8opo8y.s:209    .text:0000000000000090 .L0 
     /tmp/cc8opo8y.s:210    .text:0000000000000090 .L0 
     /tmp/cc8opo8y.s:212    .text:0000000000000090 .L0 
     /tmp/cc8opo8y.s:219    .text:000000000000009c .L0 
     /tmp/cc8opo8y.s:220    .text:000000000000009c .L0 
     /tmp/cc8opo8y.s:221    .text:000000000000009c .L0 
     /tmp/cc8opo8y.s:226    .text:00000000000000a0 .L0 
  src/../h/riscv.hpp:92     .text:00000000000000a0 .L0 
     /tmp/cc8opo8y.s:239    .text:00000000000000a4 .L0 
     /tmp/cc8opo8y.s:240    .text:00000000000000a8 .L0 
     /tmp/cc8opo8y.s:241    .text:00000000000000a8 .L0 
     /tmp/cc8opo8y.s:243    .text:00000000000000ac .L0 
     /tmp/cc8opo8y.s:244    .text:00000000000000ac .L0 
     /tmp/cc8opo8y.s:246    .text:00000000000000b0 .L0 
     /tmp/cc8opo8y.s:248    .text:00000000000000b4 .L0 
     /tmp/cc8opo8y.s:252    .text:00000000000000b8 .L0 
     /tmp/cc8opo8y.s:257    .text:00000000000000b8 .L0 
     /tmp/cc8opo8y.s:258    .text:00000000000000b8 .L0 
GAS LISTING /tmp/cc8opo8y.s 			page 12


     /tmp/cc8opo8y.s:259    .text:00000000000000b8 .L0 
src/interruptRoutine.cpp:32     .text:00000000000000b8 .L0 
     /tmp/cc8opo8y.s:266    .text:00000000000000bc .L0 
     /tmp/cc8opo8y.s:268    .text:00000000000000bc .L0 
     /tmp/cc8opo8y.s:271    .text:00000000000000c4 .L0 
     /tmp/cc8opo8y.s:275    .text:00000000000000c8 .L0 
     /tmp/cc8opo8y.s:276    .text:00000000000000c8 .L0 
     /tmp/cc8opo8y.s:277    .text:00000000000000c8 .L0 
     /tmp/cc8opo8y.s:281    .text:00000000000000d8 .L0 
     /tmp/cc8opo8y.s:287    .text:00000000000000dc .L0 
     /tmp/cc8opo8y.s:288    .text:00000000000000dc .L0 
     /tmp/cc8opo8y.s:294    .text:00000000000000e8 .L0 
     /tmp/cc8opo8y.s:295    .text:00000000000000e8 .L0 
     /tmp/cc8opo8y.s:300    .text:00000000000000f8 .L0 
     /tmp/cc8opo8y.s:301    .text:00000000000000fc .L0 
     /tmp/cc8opo8y.s:310    .text:00000000000000fc .L0 
     /tmp/cc8opo8y.s:128    .rodata:0000000000000000 .L5
     /tmp/cc8opo8y.s:120    .text:0000000000000074 .L0 
     /tmp/cc8opo8y.s:8      .rodata.str1.8:0000000000000000 .LC0
     /tmp/cc8opo8y.s:277    .text:00000000000000c8 .L0 
     /tmp/cc8opo8y.s:11     .rodata.str1.8:0000000000000018 .LC1
     /tmp/cc8opo8y.s:295    .text:00000000000000e8 .L0 
     /tmp/cc8opo8y.s:101    .text:0000000000000064 .L12
     /tmp/cc8opo8y.s:283    .text:00000000000000dc .L13
     /tmp/cc8opo8y.s:292    .text:00000000000000e8 .L10
     /tmp/cc8opo8y.s:233    .text:00000000000000a4 .L1
     /tmp/cc8opo8y.s:273    .text:00000000000000c8 .L3
     /tmp/cc8opo8y.s:217    .text:000000000000009c .L4
     /tmp/cc8opo8y.s:197    .text:000000000000008c .L7
     /tmp/cc8opo8y.s:251    .text:00000000000000b8 .L6
     /tmp/cc8opo8y.s:966    .debug_abbrev:0000000000000000 .Ldebug_abbrev0
     /tmp/cc8opo8y.s:1887   .debug_str:0000000000000408 .LASF78
     /tmp/cc8opo8y.s:1817   .debug_str:00000000000001e4 .LASF79
     /tmp/cc8opo8y.s:1811   .debug_str:000000000000019c .LASF80
     /tmp/cc8opo8y.s:5      .text:0000000000000000 .Ltext0
     /tmp/cc8opo8y.s:304    .text:00000000000000fc .Letext0
     /tmp/cc8opo8y.s:1751   .debug_line:0000000000000000 .Ldebug_line0
     /tmp/cc8opo8y.s:1843   .debug_str:00000000000002df .LASF0
     /tmp/cc8opo8y.s:1855   .debug_str:0000000000000312 .LASF1
     /tmp/cc8opo8y.s:1835   .debug_str:000000000000027f .LASF2
     /tmp/cc8opo8y.s:1823   .debug_str:000000000000022d .LASF4
     /tmp/cc8opo8y.s:1875   .debug_str:00000000000003c2 .LASF3
     /tmp/cc8opo8y.s:1769   .debug_str:0000000000000066 .LASF5
     /tmp/cc8opo8y.s:1857   .debug_str:0000000000000325 .LASF6
     /tmp/cc8opo8y.s:1841   .debug_str:00000000000002cc .LASF7
     /tmp/cc8opo8y.s:1897   .debug_str:0000000000000500 .LASF8
     /tmp/cc8opo8y.s:1809   .debug_str:000000000000018e .LASF9
     /tmp/cc8opo8y.s:1861   .debug_str:0000000000000344 .LASF10
     /tmp/cc8opo8y.s:1889   .debug_str:00000000000004cc .LASF11
     /tmp/cc8opo8y.s:1771   .debug_str:000000000000006d .LASF12
     /tmp/cc8opo8y.s:1759   .debug_str:0000000000000032 .LASF13
     /tmp/cc8opo8y.s:1775   .debug_str:0000000000000087 .LASF14
     /tmp/cc8opo8y.s:1871   .debug_str:0000000000000394 .LASF15
     /tmp/cc8opo8y.s:1781   .debug_str:00000000000000aa .LASF16
     /tmp/cc8opo8y.s:1833   .debug_str:000000000000026f .LASF30
     /tmp/cc8opo8y.s:1895   .debug_str:00000000000004f1 .LASF20
     /tmp/cc8opo8y.s:1911   .debug_str:000000000000054d .LASF17
GAS LISTING /tmp/cc8opo8y.s 			page 13


     /tmp/cc8opo8y.s:1899   .debug_str:0000000000000510 .LASF18
     /tmp/cc8opo8y.s:1883   .debug_str:00000000000003f1 .LASF19
     /tmp/cc8opo8y.s:1825   .debug_str:0000000000000234 .LASF21
     /tmp/cc8opo8y.s:1893   .debug_str:00000000000004e9 .LASF22
     /tmp/cc8opo8y.s:1869   .debug_str:0000000000000375 .LASF24
     /tmp/cc8opo8y.s:1777   .debug_str:0000000000000093 .LASF23
     /tmp/cc8opo8y.s:1757   .debug_str:0000000000000014 .LASF25
     /tmp/cc8opo8y.s:1787   .debug_str:00000000000000e4 .LASF40
     /tmp/cc8opo8y.s:1753   .debug_str:0000000000000000 .LASF26
     /tmp/cc8opo8y.s:1905   .debug_str:000000000000052f .LASF27
     /tmp/cc8opo8y.s:1859   .debug_str:0000000000000338 .LASF28
     /tmp/cc8opo8y.s:1795   .debug_str:0000000000000136 .LASF66
     /tmp/cc8opo8y.s:1839   .debug_str:0000000000000297 .LASF68
     /tmp/cc8opo8y.s:1799   .debug_str:0000000000000155 .LASF29
     /tmp/cc8opo8y.s:1851   .debug_str:0000000000000301 .LASF31
     /tmp/cc8opo8y.s:1829   .debug_str:000000000000024c .LASF81
     /tmp/cc8opo8y.s:1879   .debug_str:00000000000003db .LASF32
     /tmp/cc8opo8y.s:1849   .debug_str:00000000000002f8 .LASF33
     /tmp/cc8opo8y.s:1827   .debug_str:0000000000000243 .LASF34
     /tmp/cc8opo8y.s:1767   .debug_str:0000000000000058 .LASF35
     /tmp/cc8opo8y.s:1793   .debug_str:000000000000011b .LASF37
     /tmp/cc8opo8y.s:1881   .debug_str:00000000000003e4 .LASF36
     /tmp/cc8opo8y.s:1821   .debug_str:0000000000000213 .LASF38
     /tmp/cc8opo8y.s:1761   .debug_str:0000000000000042 .LASF42
     /tmp/cc8opo8y.s:1797   .debug_str:0000000000000140 .LASF44
     /tmp/cc8opo8y.s:1791   .debug_str:0000000000000112 .LASF39
     /tmp/cc8opo8y.s:1789   .debug_str:00000000000000fd .LASF41
     /tmp/cc8opo8y.s:1877   .debug_str:00000000000003d4 .LASF43
     /tmp/cc8opo8y.s:1865   .debug_str:000000000000035b .LASF45
     /tmp/cc8opo8y.s:1867   .debug_str:000000000000036e .LASF46
     /tmp/cc8opo8y.s:1807   .debug_str:000000000000017b .LASF47
     /tmp/cc8opo8y.s:1803   .debug_str:000000000000016d .LASF48
     /tmp/cc8opo8y.s:1783   .debug_str:00000000000000c0 .LASF49
     /tmp/cc8opo8y.s:1755   .debug_str:000000000000000c .LASF50
     /tmp/cc8opo8y.s:1815   .debug_str:00000000000001d0 .LASF51
     /tmp/cc8opo8y.s:1845   .debug_str:00000000000002ec .LASF52
     /tmp/cc8opo8y.s:1901   .debug_str:0000000000000515 .LASF53
     /tmp/cc8opo8y.s:1765   .debug_str:0000000000000051 .LASF54
     /tmp/cc8opo8y.s:1801   .debug_str:000000000000015a .LASF55
     /tmp/cc8opo8y.s:1805   .debug_str:0000000000000175 .LASF56
     /tmp/cc8opo8y.s:1885   .debug_str:00000000000003f6 .LASF57
     /tmp/cc8opo8y.s:1763   .debug_str:000000000000004b .LASF58
     /tmp/cc8opo8y.s:1915   .debug_str:0000000000000557 .LASF59
     /tmp/cc8opo8y.s:1909   .debug_str:0000000000000542 .LASF60
     /tmp/cc8opo8y.s:1873   .debug_str:00000000000003aa .LASF61
     /tmp/cc8opo8y.s:1853   .debug_str:0000000000000307 .LASF62
     /tmp/cc8opo8y.s:1831   .debug_str:0000000000000257 .LASF63
     /tmp/cc8opo8y.s:1773   .debug_str:000000000000007d .LASF64
     /tmp/cc8opo8y.s:1819   .debug_str:00000000000001fd .LASF65
     /tmp/cc8opo8y.s:1837   .debug_str:000000000000028d .LASF67
     /tmp/cc8opo8y.s:1813   .debug_str:00000000000001ba .LASF69
     /tmp/cc8opo8y.s:1779   .debug_str:0000000000000099 .LASF70
     /tmp/cc8opo8y.s:18     .text:0000000000000000 .LFB17
     /tmp/cc8opo8y.s:302    .text:00000000000000fc .LFE17
     /tmp/cc8opo8y.s:1903   .debug_str:0000000000000528 .LASF71
     /tmp/cc8opo8y.s:1630   .debug_loc:0000000000000000 .LLST0
     /tmp/cc8opo8y.s:1847   .debug_str:00000000000002f3 .LASF72
GAS LISTING /tmp/cc8opo8y.s 			page 14


     /tmp/cc8opo8y.s:1663   .debug_loc:0000000000000088 .LLST1
     /tmp/cc8opo8y.s:1737   .debug_ranges:0000000000000000 .Ldebug_ranges0
     /tmp/cc8opo8y.s:1907   .debug_str:000000000000053b .LASF73
     /tmp/cc8opo8y.s:1680   .debug_loc:00000000000000d3 .LLST3
     /tmp/cc8opo8y.s:1687   .debug_loc:00000000000000f6 .LLST4
     /tmp/cc8opo8y.s:1702   .debug_loc:0000000000000130 .LLST5
     /tmp/cc8opo8y.s:215    .text:000000000000009c .LVL9
     /tmp/cc8opo8y.s:269    .text:00000000000000c4 .LVL14
     /tmp/cc8opo8y.s:279    .text:00000000000000d8 .LVL16
     /tmp/cc8opo8y.s:223    .text:00000000000000a0 .LBB23
     /tmp/cc8opo8y.s:235    .text:00000000000000a4 .LBE23
     /tmp/cc8opo8y.s:1709   .debug_loc:0000000000000153 .LLST6
     /tmp/cc8opo8y.s:33     .text:0000000000000014 .LBB14
     /tmp/cc8opo8y.s:50     .text:0000000000000020 .LBE14
     /tmp/cc8opo8y.s:52     .text:0000000000000020 .LBB16
     /tmp/cc8opo8y.s:68     .text:000000000000002c .LBE16
     /tmp/cc8opo8y.s:88     .text:0000000000000058 .LBB19
     /tmp/cc8opo8y.s:103    .text:0000000000000064 .LBE19
     /tmp/cc8opo8y.s:1716   .debug_loc:0000000000000176 .LLST2
     /tmp/cc8opo8y.s:289    .text:00000000000000e4 .LVL18
     /tmp/cc8opo8y.s:297    .text:00000000000000f8 .LVL20
     /tmp/cc8opo8y.s:1913   .debug_str:0000000000000552 .LASF74
     /tmp/cc8opo8y.s:1891   .debug_str:00000000000004db .LASF75
     /tmp/cc8opo8y.s:1863   .debug_str:0000000000000353 .LASF77
     /tmp/cc8opo8y.s:1785   .debug_str:00000000000000d4 .LASF76
     /tmp/cc8opo8y.s:48     .text:0000000000000020 .LVL0
     /tmp/cc8opo8y.s:116    .text:000000000000006c .LVL5
     /tmp/cc8opo8y.s:250    .text:00000000000000b8 .LVL12
     /tmp/cc8opo8y.s:272    .text:00000000000000c8 .LVL15
     /tmp/cc8opo8y.s:282    .text:00000000000000dc .LVL17
     /tmp/cc8opo8y.s:291    .text:00000000000000e8 .LVL19
     /tmp/cc8opo8y.s:66     .text:000000000000002c .LVL1
     /tmp/cc8opo8y.s:222    .text:00000000000000a0 .LVL10
     /tmp/cc8opo8y.s:231    .text:00000000000000a4 .LVL11
     /tmp/cc8opo8y.s:112    .text:0000000000000068 .LVL4
     /tmp/cc8opo8y.s:119    .text:0000000000000074 .LVL6
     /tmp/cc8opo8y.s:207    .text:0000000000000090 .LVL7
     /tmp/cc8opo8y.s:213    .text:0000000000000094 .LVL8
     /tmp/cc8opo8y.s:264    .text:00000000000000bc .LVL13
     /tmp/cc8opo8y.s:87     .text:0000000000000058 .LVL2
     /tmp/cc8opo8y.s:100    .text:0000000000000064 .LVL3
     /tmp/cc8opo8y.s:311    .debug_info:0000000000000000 .Ldebug_info0
     /tmp/cc8opo8y.s:104    .text:0000000000000064 .LBB21
     /tmp/cc8opo8y.s:236    .text:00000000000000a4 .LBE21
     /tmp/cc8opo8y.s:254    .text:00000000000000b8 .LBB26
     /tmp/cc8opo8y.s:285    .text:00000000000000dc .LBE26
     /tmp/cc8opo8y.s:198    .text:000000000000008c .LBB22
     /tmp/cc8opo8y.s:218    .text:000000000000009c .LBE22
     /tmp/cc8opo8y.s:255    .text:00000000000000b8 .LBB25
     /tmp/cc8opo8y.s:284    .text:00000000000000dc .LBE25

UNDEFINED SYMBOLS
_ZN15MemoryAllocator7kmallocEm
_ZN15MemoryAllocator5kfreeEPv
_Z7printlnPKc
console_handler
